<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">

	<link rel="stylesheet" href="../../printingtoolsng-help.css" type="text/css" />

	<title>PrintingTools NG Help</title>
</head>

<body>

	<table style="width: 100%;">
		<tr>
			<td style="vertical-align: top;">
				<div style="font-size: 1.8em; font-weight: bold;">PrintingTools NG Help</div>
				<div>v2.2.0</div>
			</td>
			<td style="text-align: right; padding-right: 30px;"><img
					src="resource://printingtoolsng/icons/printing-tools-ng-icon-64px.png" /> </td>
		</tr>
	</table>



	<br>
	<h2 id="main_help">PrintingTools NG Overview</h2>
	<p>PrintingTools NG allows for many customizations to email printing. The
		extension has many options for both the headers as well as the message
		parts. Additionally Page Options can be set that cannot be done in the
		normal Thunderbird print preview. PDF output can also be done with
		auto naming using a flexible token based system.
	</p>
	<h3 class="indent0">Adding the Print NG Button to the toolbar:</h3>

	<p>
		The Print NG button should be added to the toolbar to enable both printing
		access as well as options. Additionally options can be accessed by the wrench
		button for the extension on the addon tab.
	</p>

	<div class="indent0">
		<img src="resource://printingtoolsng/icons/toolbar-button.png" />
	</div>
	<br>
	<p>
		Follow these steps to place the button on the toolbar:
	</p>
	
	<div class="indent1">
		<li>Right click on an empty space on the mail toolbar</li>
		<li>Select Custom... This will open the Customize Toolbar window</li>
		<li>Locate the Print NG button </li>
		<li>Drag and drop the button to your desired location</li>
		<li>Use the button for Print, Preview, Options and Help</li>
		
	</div>

	<h3 class="indent0">The following is an example of some of the header formatting features:</h3>
	
	<div class="indent1">
		<li>Customized header border style using CSS (top and bottom, blue)</li>
		<li>Header background color</li>
		<li>Aligned headers</li>
		<li>Customized header order</li>
		<li>Page title and message folder</li>
		<li>Attachment list with icons in header</li>
		<li>Fully customizable date format international formatting</li>
		
	</div>
	<br>
	<div class="indent0">
		<img src="resource://printingtoolsng/icons/Ptngex1.png" />
	</div>
	<br>


	<h2 id="customdate_format_help">Custom Date Format</h2>
	<p>The custom date option allows for the complete control over the date formatting
		used for both the Date and Received Date in the email headers.
		The custom date provides multiple localized options allowing almost any format.
		Note that the custom date string can include separators, literals including unicode
		characters mixed with the date\time tokens listed below.<br><br>
		Note: The custom date results in the examples below will be different based on the actual date, the users locale
		and timezone.</p>
	<br>

	<h3 class="indent0">Examples:</h3>
	<table class="dateformat-table">
		<thead>
			<tr>
				<td>Date String</td>
				<td>Result</td>
				<td>Note</td>
			</tr>
		</thead>
		<tr>
			<td><code class="code1 notranslate">%Y%0%m%1%d%2 %a %t %H:%M:%S [GMT %z]</code></td>
			<td class="notranslate">2022年04月20日 水 JST 16:06:45 [GMT +0900]</td>
			<td>ja locale with literals</td>
		</tr>
		<tr>
			<td><code class="code1 notranslate">%Y%0%m%1%d%2 %a %t %H:%M:%S</code></td>
			<td class="notranslate">2022년04월20일 수 KST 16:11:06</td>
			<td>ko locale with literals</td>
		</tr>
		<tr>
			<td><code class="code1 notranslate">%Y%0%m%1%d%2 %a %H:%M:%S %Z</code></td>
			<td class="notranslate">2022年04月20日 周三 18:01:42 北京时间</td>
			<td>zh-CN locale, short day</td>
		</tr>
		<tr>
			<td><code class="code1 notranslate">%Y%0%m%1%d%2 %A %H:%M:%S %t</code></td>
			<td class="notranslate">2022年04月20日 星期三 18:01:42 CST</td>
			<td>zh-TW locale, long day</td>
		</tr>
		<tr>
			<td><code class="code1 notranslate">%d.%m.%Y  %H:%M:%S %t</code></td>
			<td class="notranslate">20.04.2022 18:01:42 CET</td>
			<td>Dot separators</td>
		</tr>
		<tr>
			<td><code class="code1 notranslate">%a, %b %d %Y %H:%M:%S</code>
			<td class="notranslate">Mi, Apr 20 2022 18:01:42</td>
			<td>de locale, short day/month</td>
		</tr>
		<tr>
			<td><code class="code1 notranslate">%A, %B %d %Y (%H:%M:%S) %t</code></td>
			<td class="notranslate">Wednesday, April 20 2022 (18:01:42) EDT</td>
			<td>en-US locale, long day/month</td>
		</tr>

	</table>
	<br>
	<p>
		The custom date format utilizes % sequences matching the <code>strftime()</code>
		Unix like functionality. It is based on a JavaScript port of <a class="link1"
			href="http://man7.org/linux/man-pages/man3/strftime.3.html"><code>strftime()</code></a>,
		a function to format the date and time.<br>
		Port of strftime() by T. H. Doan (https://thdoan.github.io/strftime/)<br>
	</p>
	<br>
	<h3 style="margin-left: 30px;">Conversion sequence descriptions</h3>
	<table class="dateformat-table">
		<thead>
			<tr>
				<th>Sequence</th>
				<th>Description</th>
			</tr>
		</thead>
		<tbody>
			<tr>
				<td><code class="code1">%a</code></td>
				<td>Abbreviated name of the day of the week.</td>
			</tr>
			<tr>
				<td><code class="code1">%A</code></td>
				<td>Full name of the day of the week.</td>
			</tr>
			<tr>
				<td><code class="code1">%b</code></td>
				<td>Abbreviated month name.</td>
			</tr>
			<tr>
				<td><code class="code1">%B</code></td>
				<td>Full month name.</td>
			</tr>
			<tr>
				<td><code class="code1">%c</code></td>
				<td>Preferred date and time (UTC) representation for the current locale.</td>
			</tr>
			<tr>
				<td><code class="code1">%C</code></td>
				<td>Century number (year/100) as a 2-digit integer.</td>
			</tr>
			<tr>
				<td><code class="code1">%d</code></td>
				<td>Day of the month as a decimal number (range 01 to 31).</td>
			</tr>
			<tr>
				<td><code class="code1">%e</code></td>
				<td>Day of the month as a decimal number (range 1 to 31).</td>
			</tr>
			<tr>
				<td><code class="code1">%F</code></td>
				<td>ISO 8601 date format (equivalent to <code class="code1">%Y-%m-%d</code>).</td>
			</tr>
			<tr>
				<td><code class="code1">%G</code></td>
				<td>ISO 8601 week-based year with century as a decimal number. The 4-digit year corresponds
					to the ISO
					week number (see <code class="code1">%V</code>). This has the same format and value as
					<code class="code1">%Y</code>, except
					that if the ISO week number belongs to the previous or next year, that year is used
					instead.
				</td>
			</tr>
			<tr>
				<td><code class="code1">%g</code></td>
				<td>Like <code class="code1">%G</code>, but without century, that is, with a 2-digit year
					(00-99).</td>
			</tr>
			<tr>
				<td><code class="code1">%H</code></td>
				<td>Hour as a decimal number using a 24-hour clock (range 00 to 23). See also <code
						class="code1">%k</code>.</td>
			</tr>
			<tr>
				<td><code class="code1">%I</code></td>
				<td>Hour as a decimal number using a 12-hour clock (range 01 to 12). See also <code
						class="code1">%l</code>.</td>
			</tr>
			<tr>
				<td><code class="code1">%j</code></td>
				<td>Day of the year as a decimal number (range 001 to 366).</td>
			</tr>
			<tr>
				<td><code class="code1">%k</code></td>
				<td>Hour as a decimal number using a 24-hour clock (range 0 to 23). See also <code
						class="code1">%H</code>.</td>
			</tr>
			<tr>
				<td><code class="code1">%l</code></td>
				<td>Hour as a decimal number using a 12-hour clock (range 1 to 12). See also <code
						class="code1">%I</code>.</td>
			</tr>
			<tr>
				<td><code class="code1">%m</code></td>
				<td>Month as a decimal number (range 01 to 12).</td>
			</tr>
			<tr>
				<td><code class="code1">%n</code></td>
				<td>Month as a decimal number (range 1 to 12).</td>
			</tr>
			<tr>
				<td><code class="code1">%M</code></td>
				<td>Minute as a decimal number (range 00 to 59).</td>
			</tr>
			<tr>
				<td><code class="code1">%p</code></td>
				<td>Either "AM" or "PM" according to the given time value. Noon is treated as "PM" and
					midnight as "AM".
				</td>
			</tr>
			<tr>
				<td><code class="code1">%P</code></td>
				<td>Like <code class="code1">%p</code> but in lowercase ("am" or "pm").</td>
			</tr>
			<tr>
				<td><code class="code1">%s</code></td>
				<td>Number of seconds since the Epoch, 1970-01-01 00:00:00 +0000 (UTC).</td>
			</tr>
			<tr>
				<td><code class="code1">%S</code></td>
				<td>Second as a decimal number (range 00 to 59).</td>
			</tr>
			<tr>
				<td><code class="code1">%u</code></td>
				<td>Day of the week as a decimal (range 1 to 7), Monday being 1. See also <code class="code1">%w</code>.
				</td>
			</tr>
			<tr>
				<td><code class="code1">%V</code></td>
				<td>ISO 8601 week number of the current year as a decimal number (range 01 to 53), where
					week 1 is the
					first week that has at least 4 days in the new year (that is, the first Thursday).</td>
			</tr>
			<tr>
				<td><code class="code1">%w</code></td>
				<td>Day of the week as a decimal (range 0 to 6), Sunday being 0. See also <code class="code1">%u</code>.
				</td>
			</tr>
			<tr>
				<td><code class="code1">%x</code></td>
				<td>Preferred date representation for the current locale without the time.</td>
			</tr>
			<tr>
				<td><code class="code1">%X</code></td>
				<td>Preferred time representation for the current locale without the date.</td>
			</tr>
			<tr>
				<td><code class="code1">%y</code></td>
				<td>Year as a decimal number without a century (range 00 to 99).</td>
			</tr>
			<tr>
				<td><code class="code1">%Y</code></td>
				<td>Year as a decimal number including the century.</td>
			</tr>
			<tr>
				<td><code class="code1">%z</code></td>
				<td>The <code class="code1">+hhmm</code> or <code class="code1">-hhmm</code> numeric
					timezone (that is, the hour and minute offset
					from UTC).</td>
			</tr>
			<tr>
				<td><code class="code1">%Z</code></td>
				<td>Timezone name or abbreviation.</td>
			</tr>
			<tr>
				<td><code class="code1">%t</code></td>
				<td>Short Timezone abbreviation.</td>
			</tr>
			<tr>
				<td><code class="code1">%0</code></td>
				<td>Year Literal. Localized, mainly for Asian locales. (zh-CN: 年, ko: 년) </td>
			</tr>
			<tr>
				<td><code class="code1">%1</code></td>
				<td>Month Literal. Localized, mainly for Asian locales. (zh-TW: 月, ko: 월) </td>
			</tr>
			<tr>
				<td><code class="code1">%2</code></td>
				<td>Day Literal. Localized, mainly for Asian locales. (ja: 日, ko: 일) </td>
			</tr>

		</tbody>
	</table>
	<h3 class="indent0">Compatibility notes:</h3>
	<ul>
		<li><code class="code1">%c</code> - formatted string is slightly different</li>
		<li><code class="code1">%D</code> - not implemented (use <code class="code1">%m/%d/%y</code> or
			<code class="code1">%d/%m/%y</code>)
		</li>
		<li><code class="code1">%e</code> - space is not added</li>
		<li><code class="code1">%E</code> - not implemented</li>
		<li><code class="code1">%h</code> - not implemented (use <code class="code1">%b</code>)</li>
		<li><code class="code1">%k</code> - space is not added</li>
		<li><code class="code1">%n</code> - like <code class="code1">%m</code>, but no leading zero (use
			<code class="code1">\n</code> for newline)
		</li>
		<li><code class="code1">%O</code> - not implemented</li>
		<li><code class="code1">%r</code> - not implemented (use <code class="code1">%I:%M:%S %p</code>)</li>
		<li><code class="code1">%R</code> - not implemented (use <code class="code1">%H:%M</code>)</li>
		<li><code class="code1">%t</code> - not implemented (use <code class="code1">\t</code>)</li>
		<li><code class="code1">%T</code> - not implemented (use <code class="code1">%H:%M:%S</code>)</li>
		<li><code class="code1">%U</code> - not implemented</li>
		<li><code class="code1">%W</code> - not implemented</li>
		<li><code class="code1">%+</code> - not implemented</li>
		<li><code class="code1">%%</code> - not implemented (use <code class="code1">%</code>)</li>
	</ul>

	<br>

	<h2 id="pdf_output_help">PDF Output and Auto File Naming</h2>

	<p>
		PDF Output can now be both auto named using a token system and
		saved to a pre-defined PDF output directory. This is particularly
		useful when printing multiple selected emails as it is not necessary
		to choose a name and location for each email.
		<p />
	<p>
		Enable the PDF output directory and choose a directory for the save
		location. The output filename will follow the configured filename format.
		<p />
	<p>
		The filename format consists of tokens and any static characters such
		as separators or whitespace. The extended file name formatting utilizes tokens. The exact filename can be
		constructed
		utilizing the tokens as well as any text or valid filename characters.
		Invalid characters are: <code> | * : < > ? \ / " </code>
		<p />
	<p>
		The default name format is: ${subject} which is just the subject of the email.
		<p />
	<p>
		Examples</p>
	<p>
		<span class="notranslate"><code>${subject}</code></span> - The default format, subject of the email<br>
		<span class="notranslate"><code>${prefix}_${date_custom}_${sender}</code></span> - Use the custom date format
		instead of default<br>
		<span class="notranslate"><code>${subject}-GmailMsg-${date}-${index}</code></span> - With some custom text<br>
	</p>
	<p>

		The table below describes the full set of tokens that can be used in the Filename Format.
	</p>

	

	<table class="token-table">
		<tr>
			<td>Token</td>
			<td>Description</td>
		</tr>
		<tr>
			<td class="notranslate"><code>${subject}</code></td>
			<td>The subject of the message.</td>
		</tr>
		<tr>
			<td class="notranslate"><code>${sender}</code></td>
			<td>The name of the message sender.</td>
		</tr>
		<tr>
			<td class="notranslate"><code>${recipient}</code></td>
			<td>The name of the message recipient.</td>
		</tr>
		<tr>
			<td class="notranslate"><code>${sender_email}</code></td>
			<td>The e-mail address of the message sender.</td>
		</tr>
		<tr>
			<td class="notranslate"><code>${recipient_email}</code></td>
			<td>The e-mail address of the message recipient.</td>
		</tr>
		<tr>
			<td class="notranslate"><code>${smart_name}</code></td>
			<td>The recipients if the message is in a Sent folder, otherwise the sender name </td>
		</tr>
		<tr>
			<td class="notranslate"><code>${index}</code></td>
			<td>The message index number.</td>
		</tr>
		<tr>
			<td class="notranslate"><code>${prefix}</code></td>
			<td>The prefix text option value.</td>
		</tr>
		<tr>
			<td class="notranslate"><code>${suffix}</code></td>
			<td>The suffix text option value.</td>
		</tr>

		<tr>
			<td class="notranslate"><code>${date}</code></td>
			<td>The standard date format. The default format is: YYYYMMDDHHmm </td>
		</tr>
		<tr>
			<td class="notranslate"><code>${date_custom}</code></td>
			<td>The custom date format. See the custom date formatting section.</td>
		</tr>

	</table>

	<br>

	<h2 id="print_options_help">Print and Page Options</h2>
	<p>
		These options allow you to set the default printer as well as 
		per printer page options. It is	also possible to set the silent mode where the preview dialog is
		not shown and printing is done immediately.
	</p>
	<p>The page options allow you to set items when both preview
		or printing is done. These options are persistent across 
		printing. If options set in PrintingTools NG are changed 
		in the print preview they will not affect subsequent prints.
		Some items are not available to be set in the preview dialog, 
		these include the headers and footers.
		Other items are not retained by the preview and normally would
		have to be set each time a print is done. PrintingTools NG
		solves both these issues.
	</p>

	<p>
		One item not saved by the preview is the page ranges. A typical use case is where
		one wishes to print just the first page of an email as the default.
		normally one would have to make the page ranges change each time. Note 
		if a page range set in PrintingTools NG is not valid such as exceeding 
		the number of pages, the range will need to be corrected in the preview 
		before printing. A page range set to "1" will always be valid and prints 
		the first page of the message.
	</p>
	<p>Notes:</p>
	<p>The scaling option allows one to set a persistent scale.</p>
	<p>Page ranges are described the same way as in the preview. Examples are
		1, 1-2, 3-4,5. Note that if a preset page ranges is not valid for a
		given message, the preview will show an error.
	</p>
	<p>The margins can be set using units appropriate for the users locale,
		either inches or millimeters (in or mm). Note, due to rounding errors,
		some mm values may be saved with small differences.
	</p>
	<p></p>
	<p>The headers and footers can be set to include various message variables
		listed below. Additionally arbitrary text can also be included. To print 
		no headers or footers and save printing space, just make all fields blank.
	</p>
	<div class="indent1">
		<li>&D = Date</li>
		<li>&P = Page Number</li>
		<li>&PT = Page Number with Total (“3 of 5”)</li>
		<li>&T = Page Title (Subject of the message)</li>
		<li>&U = URL (The URL of the message)</li>
	</div>

	<h2>Support</h2>
	<p>
		Please post issues or feature requests in the extensions GitHub repository: <a class="link1"
			href="https://github.com/cleidigh/printing-tools-ng/issues">PrintingTools NG Issues</a><br>
		<br>
		In bug issues, include the following information to help solve the issues:<br>
		- PrintingTools NG version<br>
		- Thunderbird version<br>
		- Operating system and version<br>
		- Debug output (copy from the Debug Console - access with Control-Shift-J)<br>
		- A description of the steps leading to the issue<br>

	</p>

	<h2>Debug Options</h2>
	<p>
		The debug options are a set of keywords that are entered as a space separated 
		list. The options are typically used for console debugging output, but may also 
		be used for testing or different modes.

	</p>
	<div class="indent1">
		<li>initialsource - show message source before PTNG does any formatting</li>
		<li>finaloutput - show the final message output</li>
		<li>pdfoutput - debug output for PDF message output</li>
		<li>printsettings - debug output for print and page options</li>
		<li>helpinwin - mode flag to show help in a window instead of the standard in a tab</li>
		
	</div>

	<h2>Credits</h2>
	<div class="indent1">
		<li>PrintingTools NG is based on the original extension by Paolo "Kosmos"</li>
		<li>List.js by Jonny Strömberg https://listjs.com</li>
		<li>Latinize.js by Jakub Dundalek https://github.com/dundalek/latinize</li>
	</div>

	<p>
		Thanks to the following users for enhancement suggestions and test help:<br><br>

		- <code class="notranslate">@kiki-ja (major release and feature management help)</code><br>
		- <code class="notranslate">@RRoenn</code><br>

		- <code class="notranslate">@tidebre67</code><br>
		- <code class="notranslate">@reinerblock</code><br>
		- <code class="notranslate">@querixg</code><br>
		- <code class="notranslate">@jobisoft</code><br>
		- <code class="notranslate">@JF1313</code><br>
		- <code class="notranslate">@KC-T</code><br>
		- <code class="notranslate">@madvinegar</code><br>
		- <code class="notranslate">@ditchfinder</code><br>
		- <code class="notranslate">@3LaHoonK</code><br>
		- <code class="notranslate">@realraven</code><br>
		- <code class="notranslate">@librelegal</code><br>
		- <code class="notranslate">@Francewhoa</code><br>
		- <code class="notranslate">@foxfan100</code><br>
		- <code class="notranslate">@pechh</code><br>
	</p>


</body>

</html>